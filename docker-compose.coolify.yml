version: '3.9'

# =============================================================================
# STREAMSIDE LIVEKIT - PRODUCTION (FOR COOLIFY)
# =============================================================================
#
# SETUP IN COOLIFY:
# 1. Add this as Docker Compose service
# 2. Set environment variables (see below)
# 3. Open firewall: 7880,7881/tcp and 3478,50000-60000/udp
# =============================================================================

services:
  livekit:
    image: livekit/livekit-server:latest
    container_name: livekit-server
    restart: unless-stopped
    network_mode: host
    environment:
      # LIVEKIT_CONFIG contains the entire config as YAML
      # Set this in Coolify environment variables (see below for value)
      LIVEKIT_CONFIG: ${LIVEKIT_CONFIG}

# =============================================================================
# COOLIFY ENVIRONMENT VARIABLE:
# 
# Name: LIVEKIT_CONFIG
# Value (copy exactly, replace YOUR_API_SECRET):
# -----------------------------------------------------------------------------
# port: 7880
# bind_addresses:
#   - "0.0.0.0"
# rtc:
#   port_range_start: 50000
#   port_range_end: 60000
#   use_external_ip: true
#   tcp_port: 7881
# turn:
#   enabled: true
#   udp_port: 3478
# keys:
#   APIStreamside: YOUR_API_SECRET
# room:
#   auto_create: true
#   empty_timeout: 300
#   max_participants: 50
# logging:
#   level: info
# =============================================================================
# 
# VERCEL ENVIRONMENT VARIABLES:
# - LIVEKIT_API_KEY=APIStreamside
# - LIVEKIT_API_SECRET=YOUR_API_SECRET (same as above)
# - NEXT_PUBLIC_LIVEKIT_WS_URL=wss://YOUR_SERVER_IP:7880
# =============================================================================
